import{a as c,b as P}from"./chunk-DLTX3IJB.js";import{a as M}from"./chunk-GYCTBP6P.js";import{Ea as x,Fa as t,Ga as e,Ha as f,Ma as i,Na as d,Oa as l,Pa as s,bb as b,db as u,eb as C,fb as v,ka as o,pa as p,ta as g,va as h}from"./chunk-HIUE27M2.js";function O(m,n){if(m&1&&(t(0,"tr")(1,"td"),i(2),e(),t(3,"td"),i(4),e(),t(5,"td"),i(6),l(7,"date"),e(),t(8,"td"),i(9),l(10,"date"),e()()),m&2){let a=n.$implicit,r=n.index;o(2),d(r+1),o(2),d(a.pm10),o(2),d(s(7,4,a.fecha_hora,"yyyy-MM-dd")),o(3),d(s(10,7,a.fecha_hora,"HH:mm"))}}c.register(...P);var _=class m{constructor(n){this.pm10Service=n}data=[];chart;avg=0;min=0;max=0;ngOnInit(){this.pm10Service.getLatest(5).subscribe({next:n=>{console.log("Datos recibidos:",n),this.data=n.reverse(),this.computeStats(),this.loadChart()},error:n=>console.error("Error al cargar latest:",n)})}ngAfterViewInit(){this.data.length&&this.loadChart()}computeStats(){if(!this.data.length)return;let n=this.data.map(a=>a.pm10);this.avg=n.reduce((a,r)=>a+r,0)/n.length,this.min=Math.min(...n),this.max=Math.max(...n)}loadChart(){let n=document.getElementById("pm10Chart");n&&(this.chart&&this.chart.destroy(),this.chart=new c(n,{type:"line",data:{labels:this.data.map(a=>a.fecha_hora),datasets:[{label:"PM10",data:this.data.map(a=>a.pm10),borderColor:"#2980b9",backgroundColor:"rgba(41, 128, 185, 0.2)",fill:!0,tension:.3}]},options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{x:{display:!0},y:{display:!0}}}}))}static \u0275fac=function(a){return new(a||m)(p(M))};static \u0275cmp=g({type:m,selectors:[["app-co"]],decls:40,vars:7,consts:[[1,"dashboard"],[1,"content"],[1,"records-section"],[1,"records-table"],[4,"ngFor","ngForOf"],[1,"stats-section"],[1,"stats"],[1,"card"],[1,"chart-section"],["id","pm10Chart"]],template:function(a,r){a&1&&(t(0,"div",0)(1,"main",1)(2,"h1"),i(3,"Part\xEDculas PM10"),e(),t(4,"section",2)(5,"h2"),i(6,"\xDAltimos registros"),e(),t(7,"table",3)(8,"thead")(9,"tr")(10,"th"),i(11,"#"),e(),t(12,"th"),i(13,"PM10"),e(),t(14,"th"),i(15,"Fecha"),e(),t(16,"th"),i(17,"Hora"),e()()(),t(18,"tbody"),h(19,O,11,10,"tr",4),e()()(),t(20,"section",5)(21,"div",6)(22,"div",7)(23,"h3"),i(24,"Promedio"),e(),t(25,"p"),i(26),l(27,"number"),e()(),t(28,"div",7)(29,"h3"),i(30,"M\xEDnimo"),e(),t(31,"p"),i(32),e()(),t(33,"div",7)(34,"h3"),i(35,"M\xE1ximo"),e(),t(36,"p"),i(37),e()()()(),t(38,"section",8),f(39,"canvas",9),e()()()),a&2&&(o(19),x("ngForOf",r.data),o(7),d(s(27,4,r.avg,"1.1-2")),o(6),d(r.min),o(5),d(r.max))},dependencies:[v,b,C,u],styles:[".dashboard[_ngcontent-%COMP%]{display:flex;min-height:100vh;font-family:Arial,sans-serif}.content[_ngcontent-%COMP%]{flex:1;padding:30px;background-color:#ecf0f1}.content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:20px;font-size:26px;color:#2c3e50}.stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:20px;margin-bottom:40px}.card[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:12px;box-shadow:0 4px 6px #0000001a;text-align:center}.card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:10px;color:#2980b9}.card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#333}.records-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:20px;background-color:#fff;box-shadow:0 2px 6px #0000001a;border-radius:8px;overflow:hidden}.records-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .records-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 15px;text-align:left;border-bottom:1px solid #ddd}.records-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#2980b9;color:#fff;font-weight:700}.records-section[_ngcontent-%COMP%], .stats-section[_ngcontent-%COMP%]{margin-bottom:40px}.chart-section[_ngcontent-%COMP%]{margin-top:20px}"]})};export{_ as Pm10Component};
